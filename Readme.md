# 一、设计模式与软件开发思想
## What is ?
设计模式

    ①是一套反复使用的代码设计经验的总结
    ②是长期总结的一套高开发效率的编程方式
    ③是解决常见问题的通用解决方法
    ④是特定场景下的可重用方案

在大型软件的设计中保证了模块之间的灵活性（可扩展、低耦合）与可复用性

## 分类
1. 行为型模式：关注对象的行为，通过对象组合，描述一组对象应该如何协作来完成整体任务
2. 创建型模式：关注如何创建对象，核心思想将对象的创建和使用分离，充分解耦以解决代码难维护和难修改的问题
3. 结构型模式：关注对象之间的关系，组合对象以获得更加灵活的结构

<br>

# 二、行为模式

## 1、模板方法模式
### What is 
举例：很多事情都是由固定的步骤来完成的，例如餐馆吃饭，主要流程 —— 点餐、用餐、结账。步骤固定，可称之为模板，但是仍然有细微的差距，比如，我点淮扬菜，你点鲁菜，他点川菜；我用RMB结账，你用Dollar结账，他用微信付款。在固定的步骤下，通过多态机制在多个子类中对每个步骤的细节差异化实现，就是模板方法的目的！

<br>

## 2、迭代器模式
### What is
迭代器模式是一种行为设计模式， 在不暴露集合底层表现形式 （列表、 栈和树等） 的情况下遍历集合中所有的元素[2]。

### Before this
#### 单一职责原则
一个类尽量只负责单一功能，减少能够引起类变化的原因
#### 内聚与耦合
内聚：一个模块内部的各组成部分之间彼此结合的紧密程度

耦合：模块之间相互关联的程度，分为，

    ①内容耦合
    ②公共耦合
    ③外部耦合
    ④控制耦合
    ⑤标记耦合
    ⑥数据耦合
模块之间如果必须耦合，尽量使用数据耦合，少用控制耦合，限制公共耦合，避免内容耦合

<br>

<br>
<br>
<br>

# 三、创建模式

## 1、工厂模式
将创建对象的代码包装起来，实现创建对象的代码与具体的业务逻辑代码隔离

### 简单工厂模式
定义一个工厂类，该类的成员函数可以根据不同的参数创建并返回不同的类对象，被创建的对象所属的类一般都具有相同的父类，调用者无需关心创建对象的细节。
可以通过将创建对象的函数定义为静态函数，在不创建工厂类对象的情况下直接使用创建方法。
简单工厂模式违背开闭原则：对扩展开放，对修改关闭

### 工厂方法模式
工厂方法模式是使用频率最高的工厂模式，故工厂方法模式直接简称为工厂模式or多态工厂模式。
定义一个用于创建对象的接口，但由子类决定要实例化的类是哪一个，该模型使得某个类的实例化延迟到子类。


<br>

## 2、单例模式
### what is
单例模式是一种创建型设计模式， 让你能够保证一个类只有一个实例， 并提供一个访问该实例的全局节点[2]。

### 多线程不安全的懒汉模式
见代码V1，略

### 复杂的多线程安全方式——多重锁
简单的多重锁通用存在性能上的问题，还可能被编译器优化，只能使用原子指针来保证线程安全，同时使用了内存屏障来确保顺序性和可见性。

### 暴力的多线程安全方式——饿汉模式
在静态变量在类外初始化时即创建对象，无需在成员函数中判断变量是否为空，但是在多CPP源文件共享类的多线程环境下需要注意，应该保证在进入main函数之后再使用该类，因为静态编程初始化发生再编译期，如果其他位置再编译期使用了未初始化的静态变量，会导致使用空执行异常。

### 单例模式下类对象的析构问题
#### 手动析构
见代码V4，略
#### 自动析构
见代码V4，略

<br>

<br><br><br>

# 四、结构型模式
## 1、适配器模式
### What is 
适配器模式是一种结构型设计模式， 它能使接口不兼容的对象能够相互合作。

 


<br>
<br>
<br>
<br>

## 参考资料

[1] 《C++新经典：设计模式》王健伟

[2] https://refactoringguru.cn/design-patterns

<br>

*说明：笔记以《C++新经典：设计模式》为主线，所有未标记引用部分，均摘自或者概括自此书中的内容，所有代码也均为书中示例，无原创，仅供本人学习使用*。